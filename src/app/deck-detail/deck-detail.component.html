<div class="left padded table wid">
  <div class="mat-elevation-z8">
    <table mat-table [dataSource]="dataSource" matSort>
      <!-- Card Column -->
      <ng-container matColumnDef="card">
        <th mat-header-cell *matHeaderCellDef> Card </th>
        <td mat-cell *matCellDef="let card"> {{(card.name + (card.isFoil ? ' Foil' : '') | titlecase) 
          + ' ' + (card.cardCondition ? card.cardCondition : '') + ' x' + card.quantity}} </td>
        <td mat-footer-cell *matFooterCellDef> Total </td>
      </ng-container>

      <!-- TODO add columns -->
      <!-- Card Column -->
      <!-- <ng-container matColumnDef="quantity">
        <th mat-header-cell *matHeaderCellDef> Quantity </th>
        <td mat-cell *matCellDef="let card"> {{card.quantity}} </td>
        <td mat-footer-cell *matFooterCellDef> Total </td>
      </ng-container> -->

      <!-- Value Column -->
      <ng-container matColumnDef="value">
        <th mat-header-cell *matHeaderCellDef> Value </th>
        <td mat-cell *matCellDef="let card"> {{card.marketPrice * card.quantity | currency}} </td>
        <td mat-footer-cell *matFooterCellDef> {{getTotalCost() | currency}} </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns;"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns; let i = index" (click)="setCard(i)"></tr>
      <tr mat-footer-row *matFooterRowDef="displayedColumns"></tr>
    </table>
  </div>

  <span *ngIf="!loading">
    <button mat-raised-button (click)="refreshDeck()" class="but">Refresh</button>
  </span>
  <span *ngIf="loading">
    <button mat-raised-button class="but">
        <mat-progress-spinner style="margin:0 auto;" mode="indeterminate" [diameter]="15"></mat-progress-spinner>
    </button>
  </span>

</div>

<mat-card class="center card">
  <div *ngIf="selectedCard">
    <mat-card-title> <input [(ngModel)]="selectedCard.name" placeholder="Name"/> </mat-card-title>
      <mat-card-subtitle>	
        <input [(ngModel)]="selectedCard.version" placeholder="Version"/>
        <input [(ngModel)]="selectedCard.purchasePrice" placeholder="Purchase Price"/> 
        <!-- TODO try formgroup-->
        <mat-form-field class="form">
          <mat-label>Foil</mat-label>
          <mat-select [(value)]="selectedFoil">
            <mat-option value=false>Non-foil</mat-option>
            <mat-option value=true>Foil</mat-option>
          </mat-select>
        </mat-form-field>
        <mat-form-field class="form">
          <mat-label>Condition</mat-label>
          <mat-select [(value)]="selectedCondition">
            <mat-option value="NEAR_MINT">Near-mint</mat-option>
            <mat-option value="LIGHT_PLAY">Light-play</mat-option>
            <mat-option value="MODERATE_PLAY">Moderate-play</mat-option>
          </mat-select>
        </mat-form-field>
        <input [(ngModel)]="selectedCard.quantity" placeholder="Quantity"/> 
      </mat-card-subtitle>

      <!-- TODO pull card picture and description from backend -->
      <!-- <mat-card-content> Primary card content. Intended for blocks of text. </mat-card-content> -->
      <!-- <img mat-card-image>	Card image. Stretches the image to the container width -->
      <mat-card-actions>
        <button mat-raised-button (click)="saveCard(selectedFoil, selectedCondition)" class="padded">Save Current Card</button>
        <button mat-raised-button (click)="resetSelectedCard()" class="padded">Add New Card</button>
      </mat-card-actions>
  </div>
</mat-card>
